–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ —Å GPT-2
–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–æ–¥–µ–ª–∏ GPT-2 –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ transformers –æ—Ç Hugging Face. –í –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –∏ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞, –≤–≤–æ–¥ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ (–ø—Ä–æ–º–ø—Ç–∞), –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ —Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. –î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–æ–±–∞–≤–ª–µ–Ω –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤–∏–¥–∂–µ—Ç, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≤–≤–æ–¥–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.

üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫
–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

Python: 3.8 –∏–ª–∏ –≤—ã—à–µ
–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏:
transformers
torch
ipywidgets



–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
–î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:
pip install transformers torch ipywidgets


üìñ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
1. –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –∏ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞
–ö–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å GPT-2 –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Hugging Face.
2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞
–§—É–Ω–∫—Ü–∏—è generate_text –ø–æ–∑–≤–æ–ª—è–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–≤–µ–¥–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–ª–µ–¥—É—é—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:

max_length: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 50 —Ç–æ–∫–µ–Ω–æ–≤).
temperature: –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç —Å—Ç–µ–ø–µ–Ω—å —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏ —Ç–µ–∫—Å—Ç–∞. –ú–µ–Ω—å—à–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–µ–ª–∞—é—Ç —Ç–µ–∫—Å—Ç –±–æ–ª–µ–µ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–º, –±–æ–ª—å—à–∏–µ ‚Äî –±–æ–ª–µ–µ –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–º (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 0.8).
top_k: –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –≤—ã–±–æ—Ä–∫—É K –Ω–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω—ã–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 50).
do_sample: –í–∫–ª—é—á–∞–µ—Ç –≤—ã–±–æ—Ä–∫—É –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (–µ—Å–ª–∏ True) –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∂–∞–¥–Ω–æ–µ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ (–µ—Å–ª–∏ False). –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: True.

3. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤–∏–¥–∂–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç:

–í–≤–æ–¥–∏—Ç—å –Ω–∞—á–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç (–ø—Ä–æ–º–ø—Ç) –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ.
–ù–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é –ø–æ–ª–∑—É–Ω–∫–æ–≤ (max_length, temperature, top_k) –∏ —Ñ–ª–∞–∂–∫–∞ (do_sample).
–ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç –Ω–∞–∂–∞—Ç–∏–µ–º –∫–Ω–æ–ø–∫–∏ "Generate Text".


üõ†Ô∏è –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

–°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
git clone <URL_—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è>
cd <–Ω–∞–∑–≤–∞–Ω–∏–µ_–ø–∞–ø–∫–∏>


–ó–∞–ø—É—Å—Ç–∏—Ç–µ Jupyter Notebook:
jupyter notebook


–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª text_generation_gpt2.ipynb –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —è—á–µ–π–∫–∏ –∫–æ–¥–∞ –ø–æ –ø–æ—Ä—è–¥–∫—É.

–í –ø–æ—Å–ª–µ–¥–Ω–µ–π —è—á–µ–π–∫–µ –ø–æ—è–≤–∏—Ç—Å—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –≥–¥–µ –≤—ã —Å–º–æ–∂–µ—Ç–µ:

–í–≤–µ—Å—Ç–∏ –Ω–∞—á–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Once upon a time").
–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.
–ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "Generate Text" –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞.




üìù –ü—Ä–∏–º–µ—Ä –≤–≤–æ–¥–∞ –∏ –≤—ã–≤–æ–¥–∞
–í–≤–æ–¥

–ü—Ä–æ–º–ø—Ç: Once upon a time
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
max_length=50
temperature=0.8
top_k=50
do_sample=True



–í—ã–≤–æ–¥
–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç, –ø—Ä–æ–¥–æ–ª–∂–∞—é—â–∏–π –≤–≤–µ–¥–µ–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç, –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω –≤ –æ–±–ª–∞—Å—Ç–∏ –≤—ã–≤–æ–¥–∞.

‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏



–ü–∞—Ä–∞–º–µ—Ç—Ä
–û–ø–∏—Å–∞–Ω–∏–µ
–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é



max_length
–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤ –≤ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º–æ–º —Ç–µ–∫—Å—Ç–µ
50


temperature
–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç —Å—Ç–µ–ø–µ–Ω—å —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏ —Ç–µ–∫—Å—Ç–∞ (0.1‚Äì1.5)
0.8


top_k
–û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –≤—ã–±–æ—Ä–∫—É K –Ω–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω—ã–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏
50


do_sample
–í–∫–ª—é—á–∞–µ—Ç/–æ—Ç–∫–ª—é—á–∞–µ—Ç –≤—ã–±–æ—Ä–∫—É (True ‚Äî –≤—ã–±–æ—Ä–∫–∞, False ‚Äî –∂–∞–¥–Ω–æ–µ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ)
True



‚ÑπÔ∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

–ò–Ω—Ç–µ—Ä–Ω–µ—Ç: –î–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏ GPT-2 —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É.
–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: –î–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GPU, —Ö–æ—Ç—è –ø—Ä–æ–µ–∫—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º —Å CPU.
–í–∏–¥–∂–µ—Ç—ã: –ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Jupyter Notebook –≤ —Å—Ä–µ–¥–µ –±–µ–∑ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –≤–∏–¥–∂–µ—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, VS Code), –º–æ–≥—É—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤.
